package ji.ruucm.android.vertical_view;

import ji.ruucm.android.vertical_view.fragment.Frag01;
import android.os.AsyncTask;
import android.util.Log;
import android.view.animation.AlphaAnimation;
import android.widget.RelativeLayout;

/**
 * AsyncTask<A, B, C> - A : parameters' type of doInBackground - B : parameters'
 * type of onProgressUpdate - C : parameters' type of onPostExecute
 */
public class AsyncTask01 extends AsyncTask<String, String, String> {

	public static boolean isCanceled = false;

	private static final String RESULT_SUCCESS = "1";
	private static final String RESULT_FAIL = "0";

	RelativeLayout frag01;

	@Override
	public void onCancelled() {

	}

	@Override
	protected void onPreExecute() {

		// ImageView apple = (ImageView) this.findViewById(R.id.object_apple);

		frag01 = (RelativeLayout) Frag01.v.findViewById(R.id.background_home01);

		Log.d("AsyncTask01", "onPreExecute");

	}

	@Override
	protected String doInBackground(String... params) {

		while (true) {
			try {
				Thread.sleep(3000); // one second sleep
				// time++; // decrement time

				Log.d("AsyncTask01", "doInBackground, doInBackground : ");

				publishProgress(); // trigger onProgressUpdate()

			} catch (InterruptedException e) {
				return RESULT_FAIL;
			}
		}

	}

	/**
	 * this method is used by doInBackground because it's called on the main
	 * thread (UI thread), you can directly modify UI
	 */
	@Override
	protected void onProgressUpdate(String... value) {


		AlphaAnimation fadeInAnimation = new AlphaAnimation(0, 1);

		fadeInAnimation.setDuration(700);

		fadeInAnimation.setFillAfter(true);
		
		
		
		long chance = System.currentTimeMillis() % 8;
		if (chance < 3) {
			frag01.startAnimation(fadeInAnimation);
			frag01.setBackgroundResource(R.drawable.background_home01);
		} else if (chance < 6) {
			frag01.startAnimation(fadeInAnimation);
			frag01.setBackgroundResource(R.drawable.background_home02);
		} else if (chance < 8) {
			frag01.startAnimation(fadeInAnimation);
			frag01.setBackgroundResource(R.drawable.background_home03);
		} else
			frag01.startAnimation(fadeInAnimation);
			frag01.setBackgroundResource(R.drawable.background_home04);

		
		
		
	}

	/**
	 * this method is executed right AFTER doInBackground() on the main thread
	 * (UI thread)
	 */
	@Override
	protected void onPostExecute(String result) {
	}
}